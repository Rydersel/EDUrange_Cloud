{
  "$schema": "https://raw.githubusercontent.com/EDURange/schema/main/schemas/cdf.schema.json",
  "metadata": {
    "id": "port-scanner",
    "pack_id": "port-scanner",
    "name": "Port Scanner",
    "version": "1.0.0",
    "description": "In this challenge, you'll learn to use Metasploit's port scanning capabilities to discover and interact with network services. The target system is running multiple services on different ports (standard and non-standard). Start by using the auxiliary/scanner/portscan/tcp module to scan port ranges 1-10000, then use service-specific scanners (like auxiliary/scanner/ssh/ssh_version) to identify each service. Check standard ports (20-25, 80) and high ports (1024+). Each service contains clues pointing to others, with the flag hidden on a custom service on a non-standard port. Connect to discovered services using tools like curl, ssh, ftp, and netcat. Use 'help' when connected to unknown services to discover available commands, and 'flag' to retrieve the flag when you find the right service. Port scanning guide available at /home/kali/challenge/port-scan-guide.txt.",
    "challenge_type": "metasploit",
    "difficulty": "beginner",
    "author": "EDURange Team",
    "estimated_time": 45
  },
  "components": [
    {
      "type": "container",
      "id": "attack-container",
      "config": {
        "image": "registry.edurange.cloud/challenges/port-scanner-attack",
        "resources": {
          "cpu_limit": "500m",
          "mem_limit": "1Gi"
        },
        "securityContext": {
          "runAsNonRoot": false,
          "runAsUser": 0,
          "runAsGroup": 0,
          "allowPrivilegeEscalation": true,
          "privileged": true,
          "capabilities": {
            "add": ["CHOWN", "SETGID", "SETUID", "DAC_OVERRIDE", "SYS_ADMIN", "NET_ADMIN", "NET_BIND_SERVICE"]
          }
        }
      }
    },
    {
      "type": "container",
      "id": "defense-container",
      "config": {
        "image": "registry.edurange.cloud/challenges/port-scanner-defense",
        "resources": {
          "cpu_limit": "300m",
          "mem_limit": "512Mi"
        },
       "securityContext": {
          "runAsNonRoot": false,
          "runAsUser": 0,
          "runAsGroup": 0,
          "allowPrivilegeEscalation": true,
          "privileged": true,
          "capabilities": {
            "add": ["CHOWN", "SETGID", "SETUID", "DAC_OVERRIDE", "SYS_ADMIN", "NET_ADMIN", "NET_BIND_SERVICE"]
          }
        }
      }
    },
    {
      "type": "webosApp",
      "id": "terminal",
      "config": {
        "title": "Terminal",
        "icon": "./icons/Remote-Terminal.svg",
        "width": 60,
        "height": 55,
        "screen": "displayTerminal",
        "disabled": false,
        "favourite": true,
        "desktop_shortcut": true,
        "launch_on_startup": true,
        "additional_config": {
          "disableScrolling": true
        },
        "app_type": "terminal"
      }
    },
    {
      "type": "webosApp",
      "id": "chrome",
      "config": {
        "title": "Browser",
        "icon": "./icons/browser.svg",
        "width": 70,
        "height": 80,
        "screen": "displayChrome",
        "disabled": false,
        "favourite": true,
        "desktop_shortcut": true,
        "launch_on_startup": false,
        "app_type": "browser"
      }
    },
    {
      "type": "webosApp",
      "id": "calc",
      "config": {
        "title": "Calculator",
        "icon": "./icons/calculator.svg",
        "width": 5,
        "height": 50,
        "screen": "displayTerminalCalc",
        "disabled": false,
        "favourite": true,
        "desktop_shortcut": false,
        "launch_on_startup": false,
        "app_type": "terminal"
      }
    },
    {
      "type": "webosApp",
      "id": "codeeditor",
      "config": {
        "title": "Code Editor",
        "icon": "./icons/code-editor.svg",
        "width": 60,
        "height": 75,
        "screen": "displayCodeEditor",
        "disabled": false,
        "favourite": true,
        "desktop_shortcut": false,
        "launch_on_startup": false,
        "app_type": "editor"
      }
    },
    {
      "type": "webosApp",
      "id": "settings",
      "config": {
        "title": "Settings",
        "icon": "./icons/settings.svg",
        "width": 50,
        "height": 60,
        "screen": "displaySettings",
        "disabled": false,
        "favourite": true,
        "desktop_shortcut": false,
        "launch_on_startup": false,
        "app_type": "custom"
      }
    },
    {
      "type": "webosApp",
      "id": "cyberchef",
      "config": {
        "title": "Cyber Chef",
        "icon": "./icons/cyberchef.svg",
        "width": 75,
        "height": 85,
        "screen": "Cyberchef",
        "disabled": false,
        "favourite": true,
        "desktop_shortcut": true,
        "launch_on_startup": false,
        "app_type": "custom"
      }
    },
    {
      "type": "question",
      "id": "q1_root_flag",
      "config": {
        "text": "What is the flag you found?",
        "type": "flag",
        "points": 100,
        "answer": "CTF{vim_escalation_and_recon_master}",
        "order": 1
      }
    }
  ],
  "typeConfig": {
    "attackImage": "registry.edurange.cloud/challenges/port-scanner-attack",
    "defenseImage": "registry.edurange.cloud/challenges/port-scanner-defense",
    "securityContext": {
      "pod": {
        "fsGroup": 0,
        "runAsUser": 0,
        "runAsGroup": 0
      }
    }
  }
}
